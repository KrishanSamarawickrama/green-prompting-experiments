[system]
Think step-by-step INTERNALLY but output ONLY the final {language} code. 
Do NOT include your reasoning in the output.

Rules:
- Follow the function signature exactly.
- Avoid unnecessary libraries; use built-ins unless required.
- No print/input or file I/O.
- Add at most 3 comment lines summarizing the final approach.

[user]
Task: {{TASK_SPEC}}

Think carefully about correctness and efficiency, then output only the final code.
